(this["webpackJsonptruffle-react-redux-dapp"]=this["webpackJsonptruffle-react-redux-dapp"]||[]).push([[6],{851:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return o})),a.d(t,"d",(function(){return i}));var n=["Unbonded","Bonded","Unbonding"],r=["ProposalDeposit","GovernVoteTimeout","SlashTimeout","MinValidatorNum","MaxValidatorNum","MinStakeInPool","AdvanceNoticePeriod"],o={Voting:"1",Closed:"2"},i={Yes:1,No:2,Abstain:3}},933:function(e,t,a){"use strict";for(var n="qpzry9x8gf2tvdw0s3jn54khce6mua7l",r={},o=0;o<n.length;o++){var i=n.charAt(o);if(void 0!==r[i])throw new TypeError(i+" is ambiguous");r[i]=o}function c(e){var t=e>>25;return(33554431&e)<<5^996825010&-(t>>0&1)^642813549&-(t>>1&1)^513874426&-(t>>2&1)^1027748829&-(t>>3&1)^705979059&-(t>>4&1)}function l(e){for(var t=1,a=0;a<e.length;++a){var n=e.charCodeAt(a);if(n<33||n>126)return"Invalid prefix ("+e+")";t=c(t)^n>>5}for(t=c(t),a=0;a<e.length;++a){var r=e.charCodeAt(a);t=c(t)^31&r}return t}function s(e,t){if(t=t||90,e.length<8)return e+" too short";if(e.length>t)return"Exceeds length limit";var a=e.toLowerCase(),n=e.toUpperCase();if(e!==a&&e!==n)return"Mixed-case string "+e;var o=(e=a).lastIndexOf("1");if(-1===o)return"No separator character for "+e;if(0===o)return"Missing prefix for "+e;var i=e.slice(0,o),s=e.slice(o+1);if(s.length<6)return"Data too short";var d=l(i);if("string"===typeof d)return d;for(var u=[],m=0;m<s.length;++m){var f=s.charAt(m),h=r[f];if(void 0===h)return"Unknown character "+f;d=c(d)^h,m+6>=s.length||u.push(h)}return 1!==d?"Invalid checksum for "+e:{prefix:i,words:u}}function d(e,t,a,n){for(var r=0,o=0,i=(1<<a)-1,c=[],l=0;l<e.length;++l)for(r=r<<t|e[l],o+=t;o>=a;)o-=a,c.push(r>>o&i);if(n)o>0&&c.push(r<<a-o&i);else{if(o>=t)return"Excess padding";if(r<<a-o&i)return"Non-zero padding"}return c}e.exports={decodeUnsafe:function(){var e=s.apply(null,arguments);if("object"===typeof e)return e},decode:function(e){var t=s.apply(null,arguments);if("object"===typeof t)return t;throw new Error(t)},encode:function(e,t,a){if(a=a||90,e.length+7+t.length>a)throw new TypeError("Exceeds length limit");var r=l(e=e.toLowerCase());if("string"===typeof r)throw new Error(r);for(var o=e+"1",i=0;i<t.length;++i){var s=t[i];if(s>>5!==0)throw new Error("Non 5-bit word");r=c(r)^s,o+=n.charAt(s)}for(i=0;i<6;++i)r=c(r);for(r^=1,i=0;i<6;++i){o+=n.charAt(r>>5*(5-i)&31)}return o},toWordsUnsafe:function(e){var t=d(e,8,5,!0);if(Array.isArray(t))return t},toWords:function(e){var t=d(e,8,5,!0);if(Array.isArray(t))return t;throw new Error(t)},fromWordsUnsafe:function(e){var t=d(e,5,8,!1);if(Array.isArray(t))return t},fromWords:function(e){var t=d(e,5,8,!1);if(Array.isArray(t))return t;throw new Error(t)}}},952:function(e,t,a){"use strict";a.r(t);var n=a(27),r=a(247);var o=a(383);function i(e){return function(e){if(Array.isArray(e))return Object(r.a)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(o.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var c=a(57),l=a(58),s=a(60),d=a(59),u=a(0),m=a.n(u),f=a(1),h=a.n(f),g=a(44),v=a.n(g),p=a(84),b=a(933),E=a.n(b),S=a(123),C=a.n(S),j=a(844),w=a(877),O=a(12),k=a(120),y=a(56),I=a(847),A=a(251),D=a(954),P=a(849),x=a(842),z=a(153),M=a(256),R=function(e){Object(s.a)(a,e);var t=Object(d.a)(a);function a(e,n){var r;return Object(c.a)(this,a),(r=t.call(this,e)).onSubmit=function(){var e=r.props,t=e.onClose,a=e.candidateId;r.form.current.validateFields((function(e,n){if(!e){var o=n.value;r.contracts.DPoS.methods.delegate.cacheSend(a,C.a.utils.toWei(o.toString(),"ether")),t()}}))},r.form=m.a.createRef(),r.contracts=n.drizzle.contracts,r}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onClose,r=[{name:"value",field:"number",fieldOptions:Object(n.a)(Object(n.a)({},M.a),{},{placeholder:"The amount of CELR to delegate"}),rules:[{message:"Please enter a value!",required:!0}]}];return m.a.createElement(x.a,{title:"Delegate Stake",visible:t,onOk:this.onSubmit,onCancel:a},m.a.createElement(z.a,{ref:this.form,items:r}))}}]),a}(m.a.Component);R.contextTypes={drizzle:h.a.object};var W=R,T=function(e){Object(s.a)(a,e);var t=Object(d.a)(a);function a(e,n){var r;return Object(c.a)(this,a),(r=t.call(this,e)).onSubmit=function(){var e=r.props,t=e.onClose,a=e.candidate,n=a.args[0];r.form.current.validateFields((function(e,o){if(!e){var i=o.value;"0"===a.value.status?r.contracts.DPoS.methods.withdrawFromUnbondedCandidate.cacheSend(n,C.a.utils.toWei(i.toString(),"ether")):r.contracts.DPoS.methods.intendWithdraw.cacheSend(n,C.a.utils.toWei(i.toString(),"ether")),t()}}))},r.form=m.a.createRef(),r.contracts=n.drizzle.contracts,r}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onClose,r=[{name:"value",field:"number",fieldOptions:Object(n.a)(Object(n.a)({},M.a),{},{placeholder:"The amount of CELR to withdraw"}),rules:[{message:"Please enter a value!",required:!0}]}];return m.a.createElement(x.a,{title:"Withdraw Stake",visible:t,onOk:this.onSubmit,onCancel:a},m.a.createElement(z.a,{ref:this.form,items:r}))}}]),a}(m.a.Component);T.contextTypes={drizzle:h.a.object};var V=T,N=a(242),U=function(e){Object(s.a)(a,e);var t=Object(d.a)(a);function a(e,n){var r;return Object(c.a)(this,a),(r=t.call(this,e)).handleIncreaseCommission=function(){var e=r.props,t=e.onClose,a=e.network,n=e.candidate;r.form.current.validateFields((function(e,o){if(e)console.log(e);else{var i=o.commissionRate,c=o.rateLockEndTime;i*=N.a,c=v.a.toNumber(c)+a.block.number,i>n.value.commissionRate?r.contracts.DPoS.methods.announceIncreaseCommissionRate.cacheSend(i,c):r.contracts.DPoS.methods.nonIncreaseCommissionRate.cacheSend(i,c),t()}}))},r.state={},r.form=m.a.createRef(),r.contracts=n.drizzle.contracts,r}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onClose,n=[M.b,M.d];return m.a.createElement(x.a,{title:"Increase Commission Rate",visible:t,onOk:this.handleIncreaseCommission,onCancel:a},m.a.createElement(z.a,{ref:this.form,items:n}))}}]),a}(m.a.Component);U.contextTypes={drizzle:h.a.object};var B=Object(p.drizzleConnect)(U,(function(e){return{network:e.network}})),L=a(179),G=a(951),_=a(255),F=[{title:"Delegator",dataIndex:"delegator"},{title:"Delegated Stake",dataIndex:"delegatedStake",sorter:function(e,t){return C.a.utils.toBN(e.delegatedStake).cmp(C.a.utils.toBN(t.delegatedStake))},sortOrder:"descend",render:function(e){return Object(_.a)(e)}},{title:"Undelegating Stake",dataIndex:"undelegatingStake",render:function(e){return Object(_.a)(e)}}],q=[{title:"Intent Withdraw Amount",dataIndex:"intentAmount"},{title:"Intent Withdraw Block Height",dataIndex:"intentProposedTime"}],J=function(e){Object(s.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).expandedRowRender=function(e){var t=v.a.zip(e.intentAmounts,e.intentProposedTimes).map((function(e){var t=Object(L.a)(e,2),a=t[0],n=t[1];return{intentAmount:Object(_.a)(a),intentProposedTime:n}}));return m.a.createElement(G.a,{columns:q,dataSource:t,pagination:!1})},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.delegators.filter((function(e){return e.value})).sort((function(e,t){return e.args[1]>t.args[1]})).map((function(e){return Object(n.a)(Object(n.a)({},e.value),{},{delegator:e.args[1]})}));return m.a.createElement(G.a,{dataSource:e,columns:F,pagination:!1,expandedRowRender:this.expandedRowRender})}}]),a}(m.a.Component);var H=Object(p.drizzleConnect)(J,(function(e){return{}})),Y=a(848),K=a(867),Q=a.n(K),X=[{title:"Delegator",dataIndex:"delegatorAddr"},{title:"Delegated Stake",dataIndex:"delegatedStake",render:function(e){return Object(_.a)(e)}}],Z=function(e){Object(s.a)(a,e);var t=Object(d.a)(a);function a(e,n){var r;Object(c.a)(this,a),r=t.call(this,e);var o=e.candidateId,i=e.network.setting;return r.state={},Q.a.get("".concat(i.gateway,"/validator/candidate/").concat(o)).then((function(e){var t=e.data.result;r.setState({commissionRate:t.commission_rate,stakingPool:t.staking_pool})})).catch((function(e){console.error(e),e.response?Y.a.error(e.response.data.error):Y.a.warning("Please config gateway url in setting to load sidechain info correctly")})),Q.a.get("".concat(i.gateway,"/validator/candidate-delegators/").concat(o)).then((function(e){var t=e.data.result.map((function(e){return{candidateAddr:e.candidate_addr,delegatedStake:e.delegated_stake,delegatorAddr:e.delegator_addr}}));r.setState({delegators:t})})).catch((function(e){console.error(e),e.response?Y.a.error(e.response.data.error):Y.a.warning("Please config gateway url in setting to load sidechain info correctly")})),r}return Object(l.a)(a,[{key:"render",value:function(){var e=this.state,t=e.commissionRate,a=e.stakingPool,n=e.delegators,r=e.description,o=void 0===r?{}:r;return m.a.createElement(k.a,null,m.a.createElement(y.a,{span:12},m.a.createElement(I.a,{title:"Commission Rate",value:"".concat(100*t," %")})),m.a.createElement(y.a,{span:12},m.a.createElement(I.a,{title:"Staking Pool",value:Object(_.a)(a)})),m.a.createElement(y.a,{span:12},m.a.createElement(I.a,{title:"Website",value:o.website||"N/A"})),m.a.createElement(y.a,{span:12},m.a.createElement(I.a,{title:"Contact",value:o.security_contact||"N/A"})),m.a.createElement(y.a,{span:24},m.a.createElement(G.a,{dataSource:n,columns:X,pagination:!1})))}}]),a}(m.a.Component);Z.contextTypes={drizzle:h.a.object};var $=Object(p.drizzleConnect)(Z,(function(e){return{network:e.network}})),ee=[{title:"Delegator",dataIndex:"delegator"},{title:"Amount",dataIndex:"amount"}],te=function(e){Object(s.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.slashes,t=e.sort((function(e,t){return e.validator>t.validator})).map((function(e){return Object(n.a)(Object(n.a)({},e),{},{amount:Object(_.a)(e.amount)})}));return console.log(e),m.a.createElement(G.a,{dataSource:t,columns:ee,pagination:!1})}}]),a}(m.a.Component);var ae=Object(p.drizzleConnect)(te,(function(e){return{}})),ne=a(851),re=function(e){Object(s.a)(a,e);var t=Object(d.a)(a);function a(e,n){var r;Object(c.a)(this,a),(r=t.call(this,e)).toggleDelegateModal=function(){r.setState((function(e){return{isDelegateModalVisible:!e.isDelegateModalVisible}}))},r.toggleWithdrawModal=function(){r.setState((function(e){return{isWithdrawModalVisible:!e.isWithdrawModalVisible}}))},r.toggleCommissionModal=function(){r.setState((function(e){return{isCommissionModalVisible:!e.isCommissionModalVisible}}))},r.confirmWithdraw=function(){var e=r.state.candidateId;r.contracts.DPoS.methods.confirmWithdraw.cacheSend(e)},r.confirmIncreaseCommissionRate=function(){r.contracts.DPoS.methods.confirmIncreaseCommissionRate.cacheSend()},r.claimValidator=function(){r.contracts.DPoS.methods.claimValidator.cacheSend()},r.renderAction=function(){var e=r.props.accounts,t=r.state.candidate,a=t.value.status,n=e[0]===t.args[0],o=m.a.createElement(j.a,null,m.a.createElement(j.a.Item,{onClick:r.toggleDelegateModal},"Delegate"),"0"===a?m.a.createElement(j.a.Item,{onClick:r.toggleWithdrawModal},"Withdraw"):[m.a.createElement(j.a.Item,{onClick:r.toggleWithdrawModal},"Initialize Withdraw"),m.a.createElement(j.a.Item,{onClick:r.confirmWithdraw},"Confirm Withdraw")],n&&m.a.createElement(j.a.Item,{onClick:r.toggleCommissionModal},"Announce Increase Commission Rate"),n&&m.a.createElement(j.a.Item,{onClick:r.confirmIncreaseCommissionRate},"Confirm Increase Commission Rate"),n&&m.a.createElement(j.a.Item,{onClick:r.claimValidator},"Claim Validator"));return m.a.createElement(w.a,{overlay:o},m.a.createElement("a",{className:"ant-dropdown-link"},"Actions ",m.a.createElement(O.a,{type:"down"})))},r.renderCandidateDetail=function(){var e=r.props.SGN,t=r.state,a=t.candidate,n=t.delegators,o=t.slashes,i=a.args[0],c=a.value,l=c.minSelfStake,s=c.stakingPool,d=c.status,u=c.commissionRate,f=c.rateLockEndTime,h=v.a.chain(e.sidechainAddrMap).find((function(e){return e.args[0]===i})).get("value","").value(),g=h&&E.a.encode("sgn",E.a.toWords(C.a.utils.hexToBytes(h)));return m.a.createElement(k.a,{style:{marginTop:"10px"}},m.a.createElement(y.a,{span:12},m.a.createElement(I.a,{title:"Address",value:i})),m.a.createElement(y.a,{span:12},m.a.createElement(I.a,{title:"Status",value:ne.a[d]})),m.a.createElement(y.a,{span:12},m.a.createElement(I.a,{title:"Min Self Stake",value:Object(_.a)(l)})),m.a.createElement(y.a,{span:12},m.a.createElement(I.a,{title:"Staking Pool",value:Object(_.a)(s)})),m.a.createElement(y.a,{span:12},m.a.createElement(I.a,{title:"Commission Rate",value:"".concat(u/N.a," %")})),m.a.createElement(y.a,{span:12},m.a.createElement(I.a,{title:"Rate Lock End Time",value:"".concat(f," block height")})),m.a.createElement(y.a,{span:12},m.a.createElement(I.a,{title:"Sidechain Address",value:g})),m.a.createElement(y.a,{span:24},m.a.createElement(A.a,null,m.a.createElement(A.a.TabPane,{tab:"Delegators",key:"delegators"},m.a.createElement(H,{delegators:n})),m.a.createElement(A.a.TabPane,{tab:"Sidechain",key:"sidechain"},m.a.createElement($,{candidateId:i})),m.a.createElement(A.a.TabPane,{tab:"Slashes",key:"slashes"},m.a.createElement(ae,{slashes:o})))))},r.contracts=n.drizzle.contracts,r.state={candidate:null,slashes:[],isDelegateModalVisible:!1,isWithdrawModalVisible:!1,isCommissionModalVisible:!1};var o=e.match.params.id;return r.contracts.SGN.methods.sidechainAddrMap.cacheCall(o),r.contracts.DPoS.events.Delegate({fromBlock:0,filter:{candidate:o}},(function(e,t){if(!e){var a=t.returnValues,n=a.delegator,o=a.candidate;r.contracts.DPoS.methods.getDelegatorInfo.cacheCall(o,n)}})),r.contracts.DPoS.events.Slash({fromBlock:0,filter:{validator:o}},(function(e,t){e||r.setState({slashes:[].concat(i(r.state.slashes),[t.returnValues])})})),r}return Object(l.a)(a,[{key:"render",value:function(){var e=this.state,t=e.candidate,a=e.candidateId,n=e.isDelegateModalVisible,r=e.isWithdrawModalVisible,o=e.isCommissionModalVisible;return t?m.a.createElement(P.a,{title:"Candidate",extra:this.renderAction()},this.renderCandidateDetail(),m.a.createElement(W,{candidateId:a,visible:n,onClose:this.toggleDelegateModal}),m.a.createElement(V,{candidate:t,visible:r,onClose:this.toggleWithdrawModal}),m.a.createElement(B,{candidate:t,visible:o,onClose:this.toggleCommissionModal})):m.a.createElement(D.a,null)}}],[{key:"getDerivedStateFromProps",value:function(e){var t=e.match,a=e.DPoS,n=void 0===a?{}:a,r=t.params.id,o=v.a.values(n.getCandidateInfo),i=v.a.find(o,(function(e){return e.args[0]===r})),c=v.a.values(n.getDelegatorInfo).filter((function(e){return e.args[0]===r}));return{candidate:i,candidateId:r,delegators:c}}}]),a}(m.a.Component);re.contextTypes={drizzle:h.a.object};t.default=Object(p.drizzleConnect)(re,(function(e){var t=e.accounts,a=e.contracts,r=e.DPoS,o=e.SGN;return{accounts:t,DPoS:Object(n.a)(Object(n.a)({},r),a.DPoS),SGN:Object(n.a)(Object(n.a)({},o),a.SGN)}}))}}]);
//# sourceMappingURL=6.2eb18868.chunk.js.map