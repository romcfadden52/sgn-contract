(this["webpackJsonptruffle-react-redux-dapp"]=this["webpackJsonptruffle-react-redux-dapp"]||[]).push([[7],{851:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"d",(function(){return r}));var n=["Unbonded","Bonded","Unbonding"],i=["ProposalDeposit","GovernVoteTimeout","BlameTimeout","MinValidatorNum","MaxValidatorNum","MinStakeInPool","IncreaseRateWaitTime"],o={Voting:"1",Closed:"2"},r={Yes:1,No:2,Abstain:3}},953:function(e,t,a){"use strict";a.r(t);var n=a(27),i=a(949),o=a(57),r=a(58),c=a(60),l=a(59),s=a(0),d=a.n(s),u=a(1),m=a.n(u),f=a(45),h=a.n(f),b=a(84),g=a(844),v=a(856),p=a(12),S=a(120),C=a(56),O=a(846),j=a(251),E=a(954),k=a(849),I=a(842),w=a(152),D=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e,n){var i;return Object(o.a)(this,a),(i=t.call(this,e)).handleUpdateSidechain=function(){var e=i.props.onClose;i.form.current.validateFields((function(t,a){if(t)console.log(t);else{var n=a.sidechainAddr;n.startsWith("0x")||(n="0x"+n),i.contracts.SGN.methods.updateSidechainAddr.cacheSend(n),e()}}))},i.state={},i.form=d.a.createRef(),i.contracts=n.drizzle.contracts,i}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onClose;return d.a.createElement(I.a,{title:"Update Sidechain",visible:t,onOk:this.handleUpdateSidechain,onCancel:a},d.a.createElement(w.a,{ref:this.form,items:[{name:"sidechainAddr",label:"Sidechain Address",fieldOptions:{placeholder:"The account address on sgn"},rules:[{message:"Please enter a sidechainAddr!",required:!0}]}]}))}}]),a}(d.a.Component);D.contextTypes={drizzle:m.a.object};var z=D,M=a(123),P=a.n(M),R=a(256),y=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e,n){var i;return Object(o.a)(this,a),(i=t.call(this,e)).onSubmit=function(){var e=i.props,t=e.onClose,a=e.candidateId;i.form.current.validateFields((function(e,n){if(!e){var o=n.value;i.contracts.DPoS.methods.delegate.cacheSend(a,P.a.utils.toWei(o.toString(),"ether")),t()}}))},i.form=d.a.createRef(),i.contracts=n.drizzle.contracts,i}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onClose,i=[{name:"value",field:"number",fieldOptions:Object(n.a)(Object(n.a)({},R.a),{},{placeholder:"The amount of CELR to delegate"}),rules:[{message:"Please enter a value!",required:!0}]}];return d.a.createElement(I.a,{title:"Delegate Stake",visible:t,onOk:this.onSubmit,onCancel:a},d.a.createElement(w.a,{ref:this.form,items:i}))}}]),a}(d.a.Component);y.contextTypes={drizzle:m.a.object};var V=y,x=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e,n){var i;return Object(o.a)(this,a),(i=t.call(this,e)).onSubmit=function(){var e=i.props,t=e.onClose,a=e.candidateId;i.form.current.validateFields((function(e,n){if(!e){var o=n.value;i.contracts.DPoS.methods.intendWithdraw.cacheSend(a,P.a.utils.toWei(o.toString(),"ether")),t()}}))},i.form=d.a.createRef(),i.contracts=n.drizzle.contracts,i}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onClose,i=[{name:"value",field:"number",fieldOptions:Object(n.a)(Object(n.a)({},R.a),{},{placeholder:"The amount of CELR to withdraw"}),rules:[{message:"Please enter a value!",required:!0}]}];return d.a.createElement(I.a,{title:"Withdraw Stake",visible:t,onOk:this.onSubmit,onCancel:a},d.a.createElement(w.a,{ref:this.form,items:i}))}}]),a}(d.a.Component);x.contextTypes={drizzle:m.a.object};var T=x,A=a(196),W=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e,n){var i;return Object(o.a)(this,a),(i=t.call(this,e)).handleIncreaseCommission=function(){var e=i.props,t=e.onClose,a=e.network,n=e.candidate;i.form.current.validateFields((function(e,o){if(e)console.log(e);else{var r=o.commissionRate,c=o.rateLockEndTime;r*=A.a,c=h.a.toNumber(c)+a.block.number,r>n.value.commissionRate?i.contracts.DPoS.methods.announceIncreaseCommissionRate.cacheSend(r,c):i.contracts.DPoS.methods.nonIncreaseCommissionRate.cacheSend(r,c),t()}}))},i.state={},i.form=d.a.createRef(),i.contracts=n.drizzle.contracts,i}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onClose,n=[R.b,R.d];return d.a.createElement(I.a,{title:"Increase Commission Rate",visible:t,onOk:this.handleIncreaseCommission,onCancel:a},d.a.createElement(w.a,{ref:this.form,items:n}))}}]),a}(d.a.Component);W.contextTypes={drizzle:m.a.object};var N=Object(b.drizzleConnect)(W,(function(e){return{network:e.network}})),G=a(179),U=a(952),B=a(255),F=[{title:"Delegator",dataIndex:"delegator"},{title:"Delegated Stake",dataIndex:"delegatedStake"},{title:"Undelegating Stake",dataIndex:"undelegatingStake"}],L=[{title:"Intent Withdraw Amount",dataIndex:"intentAmount"},{title:"Intent Withdraw Block Height",dataIndex:"intentProposedTime"}],q=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).expandedRowRender=function(e){var t=h.a.zip(e.intentAmounts,e.intentProposedTimes).map((function(e){var t=Object(G.a)(e,2),a=t[0],n=t[1];return{intentAmount:Object(B.a)(a),intentProposedTime:n}}));return d.a.createElement(U.a,{columns:L,dataSource:t,pagination:!1})},e}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props.delegators.filter((function(e){return e.value})).sort((function(e,t){return e.args[1]>t.args[1]})).map((function(e){return Object(n.a)(Object(n.a)({},e.value),{},{delegator:e.args[1],delegatedStake:Object(B.a)(e.value.delegatedStake),undelegatingStake:Object(B.a)(e.value.undelegatingStake)})}));return d.a.createElement(U.a,{dataSource:e,columns:F,pagination:!1,expandedRowRender:this.expandedRowRender})}}]),a}(d.a.Component);var J=Object(b.drizzleConnect)(q,(function(e){})),H=a(848),Y=a(869),K=a.n(Y),Q=[{title:"Delegator",dataIndex:"delegatorAddr"},{title:"Delegated Stake",dataIndex:"delegatedStake",render:function(e){return Object(B.a)(e)}}],X=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e,i){var r;Object(o.a)(this,a),r=t.call(this,e);var c=e.candidateId,l=e.network.setting;return console.log(e.network.setting),r.state={},K.a.get("".concat(l.gateway,"/validator/candidate/").concat(c)).then((function(e){r.setState(Object(n.a)({},e.data.result))})).catch((function(e){console.error(e),H.a.warning("Please config gateway url in setting to load sidechain info correctly")})),r}return Object(r.a)(a,[{key:"render",value:function(){var e=this.state,t=e.commissionRate,a=e.stakingPool,n=e.delegators;return d.a.createElement(S.a,null,d.a.createElement(C.a,{span:12},d.a.createElement(O.a,{title:"Commission Rate",value:"".concat(100*t," %")})),d.a.createElement(C.a,{span:12},d.a.createElement(O.a,{title:"Staking Pool",value:Object(B.a)(a)})),d.a.createElement(C.a,{span:24},d.a.createElement(U.a,{dataSource:n,columns:Q,pagination:!1})))}}]),a}(d.a.Component);X.contextTypes={drizzle:m.a.object};var Z=Object(b.drizzleConnect)(X,(function(e){return{network:e.network}})),$=[{title:"Delegator",dataIndex:"delegator"},{title:"Amount",dataIndex:"amount"}],_=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props.punishes,t=e.sort((function(e,t){return e.validator>t.validator})).map((function(e){return Object(n.a)(Object(n.a)({},e),{},{amount:Object(B.a)(e.amount)})}));return console.log(e),d.a.createElement(U.a,{dataSource:t,columns:$,pagination:!1})}}]),a}(d.a.Component);var ee=Object(b.drizzleConnect)(_,(function(e){})),te=a(851),ae=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e,n){var r;Object(o.a)(this,a),(r=t.call(this,e)).toggleSidechainModal=function(){r.setState((function(e){return{isSidechainModalVisible:!e.isSidechainModalVisible}}))},r.toggleDelegateModal=function(){r.setState((function(e){return{isDelegateModalVisible:!e.isDelegateModalVisible}}))},r.toggleWithdrawModal=function(){r.setState((function(e){return{isWithdrawModalVisible:!e.isWithdrawModalVisible}}))},r.toggleCommissionModal=function(){r.setState((function(e){return{isCommissionModalVisible:!e.isCommissionModalVisible}}))},r.confirmWithdraw=function(){var e=r.state.candidateId;r.contracts.DPoS.methods.confirmWithdraw.cacheSend(e)},r.confirmIncreaseCommissionRate=function(){r.contracts.DPoS.methods.confirmIncreaseCommissionRate.cacheSend()},r.claimValidator=function(){r.contracts.DPoS.methods.claimValidator.cacheSend()},r.renderAction=function(){var e=r.props.accounts,t=r.state.candidate,a=e[0]===t.args[0],n=d.a.createElement(g.a,null,d.a.createElement(g.a.Item,{onClick:r.toggleSidechainModal},"Update Sidechain"),d.a.createElement(g.a.Item,{onClick:r.toggleDelegateModal},"Delegate"),d.a.createElement(g.a.Item,{onClick:r.toggleWithdrawModal},"Initialize Withdraw"),d.a.createElement(g.a.Item,{onClick:r.confirmWithdraw},"Confirm Withdraw"),a&&d.a.createElement(g.a.Item,{onClick:r.toggleCommissionModal},"Announce Increase Commission Rate"),a&&d.a.createElement(g.a.Item,{onClick:r.confirmIncreaseCommissionRate},"Confirm Increase Commission Rate"),a&&d.a.createElement(g.a.Item,{onClick:r.claimValidator},"Claim Validator"));return d.a.createElement(v.a,{overlay:n},d.a.createElement("a",{className:"ant-dropdown-link"},"Actions ",d.a.createElement(p.a,{type:"down"})))},r.renderCandidateDetail=function(){var e=r.props.SGN,t=r.state,a=t.candidate,n=t.delegators,i=t.punishes,o=a.args[0],c=a.value,l=c.minSelfStake,s=c.stakingPool,u=c.status,m=c.commissionRate,f=c.rateLockEndTime,b=h.a.find(e.sidechainAddrMap,(function(e){return e.args[0]===o}));return d.a.createElement(S.a,{style:{marginTop:"10px"}},d.a.createElement(C.a,{span:12},d.a.createElement(O.a,{title:"Address",value:o})),d.a.createElement(C.a,{span:12},d.a.createElement(O.a,{title:"Status",value:te.a[u]})),d.a.createElement(C.a,{span:12},d.a.createElement(O.a,{title:"Min Self Stake",value:Object(B.a)(l)})),d.a.createElement(C.a,{span:12},d.a.createElement(O.a,{title:"Staking Pool",value:Object(B.a)(s)})),d.a.createElement(C.a,{span:12},d.a.createElement(O.a,{title:"Commission Rate",value:"".concat(m/A.a," %")})),d.a.createElement(C.a,{span:12},d.a.createElement(O.a,{title:"Rate Lock End Time",value:"".concat(f," block height")})),d.a.createElement(C.a,{span:12},d.a.createElement(O.a,{title:"Sidechain Address",value:h.a.get(b,"value")})),d.a.createElement(C.a,{span:24},d.a.createElement(j.a,null,d.a.createElement(j.a.TabPane,{tab:"Delegators",key:"delegators"},d.a.createElement(J,{delegators:n})),d.a.createElement(j.a.TabPane,{tab:"Sidechain",key:"sidechain"},d.a.createElement(Z,{candidateId:o})),d.a.createElement(j.a.TabPane,{tab:"Punishes",key:"punishes"},d.a.createElement(ee,{punishes:i})))))},r.contracts=n.drizzle.contracts,r.state={candidate:null,punishes:[],isSidechainModalVisible:!1,isDelegateModalVisible:!1,isWithdrawModalVisible:!1,isCommissionModalVisible:!1};var c=e.match.params.id;return r.contracts.SGN.methods.sidechainAddrMap.cacheCall(c),r.contracts.DPoS.events.Delegate({fromBlock:0,filter:{candidate:c}},(function(e,t){if(!e){var a=t.returnValues,n=a.delegator,i=a.candidate;r.contracts.DPoS.methods.getDelegatorInfo.cacheCall(i,n)}})),r.contracts.DPoS.events.Punish({fromBlock:0,filter:{validator:c}},(function(e,t){e||r.setState({punishes:[].concat(Object(i.a)(r.state.punishes),[t.returnValues])})})),r}return Object(r.a)(a,[{key:"render",value:function(){var e=this.state,t=e.candidate,a=e.candidateId,n=e.isSidechainModalVisible,i=e.isDelegateModalVisible,o=e.isWithdrawModalVisible,r=e.isCommissionModalVisible;return t?d.a.createElement(k.a,{title:"Candidate",extra:this.renderAction()},this.renderCandidateDetail(),d.a.createElement(z,{visible:n,onClose:this.toggleSidechainModal}),d.a.createElement(V,{candidateId:a,visible:i,onClose:this.toggleDelegateModal}),d.a.createElement(T,{candidateId:a,visible:o,onClose:this.toggleWithdrawModal}),d.a.createElement(N,{candidate:t,visible:r,onClose:this.toggleCommissionModal})):d.a.createElement(E.a,null)}}],[{key:"getDerivedStateFromProps",value:function(e){var t=e.match,a=e.DPoS,n=void 0===a?{}:a,i=t.params.id,o=h.a.values(n.getCandidateInfo),r=h.a.find(o,(function(e){return e.args[0]===i})),c=h.a.values(n.getDelegatorInfo).filter((function(e){return e.args[0]===i}));return{candidate:r,candidateId:i,delegators:c}}}]),a}(d.a.Component);ae.contextTypes={drizzle:m.a.object};t.default=Object(b.drizzleConnect)(ae,(function(e){var t=e.accounts,a=e.contracts,i=e.DPoS,o=e.SGN;return{accounts:t,DPoS:Object(n.a)(Object(n.a)({},i),a.DPoS),SGN:Object(n.a)(Object(n.a)({},o),a.SGN)}}))}}]);
//# sourceMappingURL=7.58da21c6.chunk.js.map