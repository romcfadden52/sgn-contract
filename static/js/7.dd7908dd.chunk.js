(this["webpackJsonptruffle-react-redux-dapp"]=this["webpackJsonptruffle-react-redux-dapp"]||[]).push([[7],{851:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return r})),a.d(t,"d",(function(){return i}));var n=["Unbonded","Bonded","Unbonding"],o=["ProposalDeposit","GovernVoteTimeout","BlameTimeout","MinValidatorNum","MaxValidatorNum","MinStakeInPool","IncreaseRateWaitTime"],r={Voting:"1",Closed:"2"},i={Yes:1,No:2,Abstain:3}},955:function(e,t,a){"use strict";a.r(t);var n=a(27),o=a(950),r=a(57),i=a(58),c=a(60),l=a(59),s=a(0),d=a.n(s),u=a(1),m=a.n(u),f=a(44),h=a.n(f),b=a(84),g=a(878),v=a.n(g),p=a(123),S=a.n(p),C=a(844),j=a(856),O=a(12),E=a(120),k=a(56),I=a(846),w=a(251),D=a(956),P=a(849),z=a(842),M=a(153),R=a(256),y=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e,n){var o;return Object(r.a)(this,a),(o=t.call(this,e)).onSubmit=function(){var e=o.props,t=e.onClose,a=e.candidateId;o.form.current.validateFields((function(e,n){if(!e){var r=n.value;o.contracts.DPoS.methods.delegate.cacheSend(a,S.a.utils.toWei(r.toString(),"ether")),t()}}))},o.form=d.a.createRef(),o.contracts=n.drizzle.contracts,o}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onClose,o=[{name:"value",field:"number",fieldOptions:Object(n.a)(Object(n.a)({},R.a),{},{placeholder:"The amount of CELR to delegate"}),rules:[{message:"Please enter a value!",required:!0}]}];return d.a.createElement(z.a,{title:"Delegate Stake",visible:t,onOk:this.onSubmit,onCancel:a},d.a.createElement(M.a,{ref:this.form,items:o}))}}]),a}(d.a.Component);y.contextTypes={drizzle:m.a.object};var x=y,V=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e,n){var o;return Object(r.a)(this,a),(o=t.call(this,e)).onSubmit=function(){var e=o.props,t=e.onClose,a=e.candidate,n=a.args[0];o.form.current.validateFields((function(e,r){if(!e){var i=r.value;0===a.value.status?o.contracts.DPoS.methods.withdrawFromUnbondedCandidate.cacheSend(n,S.a.utils.toWei(i.toString(),"ether")):o.contracts.DPoS.methods.intendWithdraw.cacheSend(n,S.a.utils.toWei(i.toString(),"ether")),t()}}))},o.form=d.a.createRef(),o.contracts=n.drizzle.contracts,o}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onClose,o=[{name:"value",field:"number",fieldOptions:Object(n.a)(Object(n.a)({},R.a),{},{placeholder:"The amount of CELR to withdraw"}),rules:[{message:"Please enter a value!",required:!0}]}];return d.a.createElement(z.a,{title:"Withdraw Stake",visible:t,onOk:this.onSubmit,onCancel:a},d.a.createElement(M.a,{ref:this.form,items:o}))}}]),a}(d.a.Component);V.contextTypes={drizzle:m.a.object};var T=V,W=a(242),A=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e,n){var o;return Object(r.a)(this,a),(o=t.call(this,e)).handleIncreaseCommission=function(){var e=o.props,t=e.onClose,a=e.network,n=e.candidate;o.form.current.validateFields((function(e,r){if(e)console.log(e);else{var i=r.commissionRate,c=r.rateLockEndTime;i*=W.a,c=h.a.toNumber(c)+a.block.number,i>n.value.commissionRate?o.contracts.DPoS.methods.announceIncreaseCommissionRate.cacheSend(i,c):o.contracts.DPoS.methods.nonIncreaseCommissionRate.cacheSend(i,c),t()}}))},o.state={},o.form=d.a.createRef(),o.contracts=n.drizzle.contracts,o}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onClose,n=[R.b,R.d];return d.a.createElement(z.a,{title:"Increase Commission Rate",visible:t,onOk:this.handleIncreaseCommission,onCancel:a},d.a.createElement(M.a,{ref:this.form,items:n}))}}]),a}(d.a.Component);A.contextTypes={drizzle:m.a.object};var N=Object(b.drizzleConnect)(A,(function(e){return{network:e.network}})),B=a(179),G=a(954),F=a(255),L=[{title:"Delegator",dataIndex:"delegator"},{title:"Delegated Stake",dataIndex:"delegatedStake"},{title:"Undelegating Stake",dataIndex:"undelegatingStake"}],U=[{title:"Intent Withdraw Amount",dataIndex:"intentAmount"},{title:"Intent Withdraw Block Height",dataIndex:"intentProposedTime"}],q=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(r.a)(this,a);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).expandedRowRender=function(e){var t=h.a.zip(e.intentAmounts,e.intentProposedTimes).map((function(e){var t=Object(B.a)(e,2),a=t[0],n=t[1];return{intentAmount:Object(F.a)(a),intentProposedTime:n}}));return d.a.createElement(G.a,{columns:U,dataSource:t,pagination:!1})},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props.delegators.filter((function(e){return e.value})).sort((function(e,t){return e.args[1]>t.args[1]})).map((function(e){return Object(n.a)(Object(n.a)({},e.value),{},{delegator:e.args[1],delegatedStake:Object(F.a)(e.value.delegatedStake),undelegatingStake:Object(F.a)(e.value.undelegatingStake)})}));return d.a.createElement(G.a,{dataSource:e,columns:L,pagination:!1,expandedRowRender:this.expandedRowRender})}}]),a}(d.a.Component);var J=Object(b.drizzleConnect)(q,(function(e){})),H=a(848),Y=a(869),K=a.n(Y),Q=[{title:"Delegator",dataIndex:"delegatorAddr"},{title:"Delegated Stake",dataIndex:"delegatedStake",render:function(e){return Object(F.a)(e)}}],X=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e,o){var i;Object(r.a)(this,a),i=t.call(this,e);var c=e.candidateId,l=e.network.setting;return i.state={},K.a.get("".concat(l.gateway,"/validator/candidate/").concat(c)).then((function(e){i.setState(Object(n.a)({},e.data.result))})).catch((function(e){console.error(e),H.a.warning("Please config gateway url in setting to load sidechain info correctly")})),i}return Object(i.a)(a,[{key:"render",value:function(){var e=this.state,t=e.commissionRate,a=e.stakingPool,n=e.delegators;return d.a.createElement(E.a,null,d.a.createElement(k.a,{span:12},d.a.createElement(I.a,{title:"Commission Rate",value:"".concat(100*t," %")})),d.a.createElement(k.a,{span:12},d.a.createElement(I.a,{title:"Staking Pool",value:Object(F.a)(a)})),d.a.createElement(k.a,{span:24},d.a.createElement(G.a,{dataSource:n,columns:Q,pagination:!1})))}}]),a}(d.a.Component);X.contextTypes={drizzle:m.a.object};var Z=Object(b.drizzleConnect)(X,(function(e){return{network:e.network}})),$=[{title:"Delegator",dataIndex:"delegator"},{title:"Amount",dataIndex:"amount"}],_=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(r.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props.punishes,t=e.sort((function(e,t){return e.validator>t.validator})).map((function(e){return Object(n.a)(Object(n.a)({},e),{},{amount:Object(F.a)(e.amount)})}));return console.log(e),d.a.createElement(G.a,{dataSource:t,columns:$,pagination:!1})}}]),a}(d.a.Component);var ee=Object(b.drizzleConnect)(_,(function(e){})),te=a(851),ae=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e,n){var i;Object(r.a)(this,a),(i=t.call(this,e)).toggleDelegateModal=function(){i.setState((function(e){return{isDelegateModalVisible:!e.isDelegateModalVisible}}))},i.toggleWithdrawModal=function(){i.setState((function(e){return{isWithdrawModalVisible:!e.isWithdrawModalVisible}}))},i.toggleCommissionModal=function(){i.setState((function(e){return{isCommissionModalVisible:!e.isCommissionModalVisible}}))},i.confirmWithdraw=function(){var e=i.state.candidateId;i.contracts.DPoS.methods.confirmWithdraw.cacheSend(e)},i.confirmIncreaseCommissionRate=function(){i.contracts.DPoS.methods.confirmIncreaseCommissionRate.cacheSend()},i.claimValidator=function(){i.contracts.DPoS.methods.claimValidator.cacheSend()},i.renderAction=function(){var e=i.props.accounts,t=i.state.candidate,a=e[0]===t.args[0],n=d.a.createElement(C.a,null,d.a.createElement(C.a.Item,{onClick:i.toggleDelegateModal},"Delegate"),d.a.createElement(C.a.Item,{onClick:i.toggleWithdrawModal},"Initialize Withdraw"),d.a.createElement(C.a.Item,{onClick:i.confirmWithdraw},"Confirm Withdraw"),a&&d.a.createElement(C.a.Item,{onClick:i.toggleCommissionModal},"Announce Increase Commission Rate"),a&&d.a.createElement(C.a.Item,{onClick:i.confirmIncreaseCommissionRate},"Confirm Increase Commission Rate"),a&&d.a.createElement(C.a.Item,{onClick:i.claimValidator},"Claim Validator"));return d.a.createElement(j.a,{overlay:n},d.a.createElement("a",{className:"ant-dropdown-link"},"Actions ",d.a.createElement(O.a,{type:"down"})))},i.renderCandidateDetail=function(){var e=i.props.SGN,t=i.state,a=t.candidate,n=t.delegators,o=t.punishes,r=a.args[0],c=a.value,l=c.minSelfStake,s=c.stakingPool,u=c.status,m=c.commissionRate,f=c.rateLockEndTime,b=h.a.chain(e.sidechainAddrMap).find((function(e){return e.args[0]===r})).get("value","").value(),g=b&&v.a.encode("cosmos",v.a.toWords(S.a.utils.hexToBytes(b)));return d.a.createElement(E.a,{style:{marginTop:"10px"}},d.a.createElement(k.a,{span:12},d.a.createElement(I.a,{title:"Address",value:r})),d.a.createElement(k.a,{span:12},d.a.createElement(I.a,{title:"Status",value:te.a[u]})),d.a.createElement(k.a,{span:12},d.a.createElement(I.a,{title:"Min Self Stake",value:Object(F.a)(l)})),d.a.createElement(k.a,{span:12},d.a.createElement(I.a,{title:"Staking Pool",value:Object(F.a)(s)})),d.a.createElement(k.a,{span:12},d.a.createElement(I.a,{title:"Commission Rate",value:"".concat(m/W.a," %")})),d.a.createElement(k.a,{span:12},d.a.createElement(I.a,{title:"Rate Lock End Time",value:"".concat(f," block height")})),d.a.createElement(k.a,{span:12},d.a.createElement(I.a,{title:"Sidechain Address",value:g})),d.a.createElement(k.a,{span:24},d.a.createElement(w.a,null,d.a.createElement(w.a.TabPane,{tab:"Delegators",key:"delegators"},d.a.createElement(J,{delegators:n})),d.a.createElement(w.a.TabPane,{tab:"Sidechain",key:"sidechain"},d.a.createElement(Z,{candidateId:r})),d.a.createElement(w.a.TabPane,{tab:"Punishes",key:"punishes"},d.a.createElement(ee,{punishes:o})))))},i.contracts=n.drizzle.contracts,i.state={candidate:null,punishes:[],isDelegateModalVisible:!1,isWithdrawModalVisible:!1,isCommissionModalVisible:!1};var c=e.match.params.id;return i.contracts.SGN.methods.sidechainAddrMap.cacheCall(c),i.contracts.DPoS.events.Delegate({fromBlock:0,filter:{candidate:c}},(function(e,t){if(!e){var a=t.returnValues,n=a.delegator,o=a.candidate;i.contracts.DPoS.methods.getDelegatorInfo.cacheCall(o,n)}})),i.contracts.DPoS.events.Punish({fromBlock:0,filter:{validator:c}},(function(e,t){e||i.setState({punishes:[].concat(Object(o.a)(i.state.punishes),[t.returnValues])})})),i}return Object(i.a)(a,[{key:"render",value:function(){var e=this.state,t=e.candidate,a=e.candidateId,n=e.isDelegateModalVisible,o=e.isWithdrawModalVisible,r=e.isCommissionModalVisible;return t?d.a.createElement(P.a,{title:"Candidate",extra:this.renderAction()},this.renderCandidateDetail(),d.a.createElement(x,{candidateId:a,visible:n,onClose:this.toggleDelegateModal}),d.a.createElement(T,{candidate:t,visible:o,onClose:this.toggleWithdrawModal}),d.a.createElement(N,{candidate:t,visible:r,onClose:this.toggleCommissionModal})):d.a.createElement(D.a,null)}}],[{key:"getDerivedStateFromProps",value:function(e){var t=e.match,a=e.DPoS,n=void 0===a?{}:a,o=t.params.id,r=h.a.values(n.getCandidateInfo),i=h.a.find(r,(function(e){return e.args[0]===o})),c=h.a.values(n.getDelegatorInfo).filter((function(e){return e.args[0]===o}));return{candidate:i,candidateId:o,delegators:c}}}]),a}(d.a.Component);ae.contextTypes={drizzle:m.a.object};t.default=Object(b.drizzleConnect)(ae,(function(e){var t=e.accounts,a=e.contracts,o=e.DPoS,r=e.SGN;return{accounts:t,DPoS:Object(n.a)(Object(n.a)({},o),a.DPoS),SGN:Object(n.a)(Object(n.a)({},r),a.SGN)}}))}}]);
//# sourceMappingURL=7.dd7908dd.chunk.js.map